- name: Run RCU for OPSS, IAU, IAU_APPEND, IAU_VIEWER components
  expect:
    command: >
      ./rcu -silent -createRepository
      -connectString {{ db_host }}:{{ db_port_ssl }}:{{ db_service }}
      -dbUser sys
      -dbRole sysdba
      -useSSL
      -sslArgs
      javax.net.ssl.trustStore={{ wallet_dir }}/ewallet.p12,
      javax.net.ssl.trustStoreType=PKCS12,
      javax.net.ssl.keyStore={{ wallet_dir }}/ewallet.p12,
      javax.net.ssl.keyStoreType=PKCS12,
      oracle.net.ssl_server_dn_match=true,
      oracle.net.authentication_services=TCPS
      -sslPasswordArgNames javax.net.ssl.keyStorePassword,javax.net.ssl.trustStorePassword
      -schemaPrefix {{ schema_prefix }}
      -component OPSS -component IAU -component IAU_APPEND -component IAU_VIEWER
      -serverDN CN={{ db_host }}
    responses:
      '.*javax.net.ssl.keyStorePassword.*': "{{ keystore_password }}"
      '.*javax.net.ssl.trustStorePassword.*': "{{ truststore_password }}"
      '.*database password.*': "{{ db_sys_password }}"
      '.*schema password for \[OAS_OPSS\].*': "{{ opss_password }}"
      '.*schema password for \[OAS_IAU\].*': "{{ iau_password }}"
      '.*schema password for \[OAS_IAU_APPEND\].*': "{{ iau_append_password }}"
      '.*schema password for \[OAS_IAU_VIEWER\].*': "{{ iau_viewer_password }}"
  args:
    chdir: "{{ fmw_home }}/oracle_common/bin"
